import React from 'react';

// 二、需求分析
export const MA02_Requirements: React.FC = () => {
    return (
        <div className="page bg-white w-[210mm] min-h-[297mm] mx-auto shadow-lg mb-8 p-12 page-break">
            <h2 className="text-[18pt] font-hei mb-6 font-bold">二、需求分析</h2>

            <h3 className="text-[14pt] font-hei font-bold mt-6 mb-4">2.1 功能需求</h3>
            
            <h4 className="text-[12pt] font-hei font-bold mt-4 mb-2">2.1.1 沙箱环境搭建</h4>
            <ul className="list-disc ml-12 mb-4 space-y-1">
                <li>构建隔离的恶意软件运行环境，防止样本逃逸</li>
                <li>配置网络监控，捕获所有出入流量</li>
                <li>支持快照恢复，便于重复分析</li>
                <li>集成常用分析工具链</li>
            </ul>

            <h4 className="text-[12pt] font-hei font-bold mt-4 mb-2">2.1.2 流量分析功能</h4>
            <ul className="list-disc ml-12 mb-4 space-y-1">
                <li>实时捕获恶意样本产生的网络流量</li>
                <li>识别C2通信协议和通信模式</li>
                <li>提取加密通信的密钥和算法</li>
                <li>解密并还原C2指令内容</li>
            </ul>

            <h4 className="text-[12pt] font-hei font-bold mt-4 mb-2">2.1.3 逆向分析功能</h4>
            <ul className="list-disc ml-12 mb-4 space-y-1">
                <li>对恶意样本进行静态反编译分析</li>
                <li>识别恶意代码的功能模块</li>
                <li>定位持久化机制（注册表、计划任务等）</li>
                <li>提取硬编码的配置信息和密钥</li>
            </ul>

            <h4 className="text-[12pt] font-hei font-bold mt-4 mb-2">2.1.4 检测规则编写</h4>
            <ul className="list-disc ml-12 mb-4 space-y-1">
                <li>基于流量特征编写Snort/Suricata规则</li>
                <li>实现对该恶意样本流量的100%检出</li>
                <li>最小化误报率</li>
                <li>规则可部署到生产环境</li>
            </ul>

            <h3 className="text-[14pt] font-hei font-bold mt-6 mb-4">2.2 分析流程设计</h3>
            <div className="bg-gray-50 p-4 rounded-lg mb-4">
                <table className="w-full border-collapse">
                    <thead>
                        <tr className="bg-blue-100">
                            <th className="border border-gray-400 p-2">阶段</th>
                            <th className="border border-gray-400 p-2">任务</th>
                            <th className="border border-gray-400 p-2">工具</th>
                            <th className="border border-gray-400 p-2">输出</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td className="border border-gray-400 p-2 text-center">1</td>
                            <td className="border border-gray-400 p-2">样本初步分析</td>
                            <td className="border border-gray-400 p-2">file, strings, md5sum</td>
                            <td className="border border-gray-400 p-2">文件类型、哈希值</td>
                        </tr>
                        <tr>
                            <td className="border border-gray-400 p-2 text-center">2</td>
                            <td className="border border-gray-400 p-2">动态行为分析</td>
                            <td className="border border-gray-400 p-2">沙箱、Wireshark</td>
                            <td className="border border-gray-400 p-2">网络流量、行为日志</td>
                        </tr>
                        <tr>
                            <td className="border border-gray-400 p-2 text-center">3</td>
                            <td className="border border-gray-400 p-2">流量解密分析</td>
                            <td className="border border-gray-400 p-2">Wireshark、Python</td>
                            <td className="border border-gray-400 p-2">解密后的C2指令</td>
                        </tr>
                        <tr>
                            <td className="border border-gray-400 p-2 text-center">4</td>
                            <td className="border border-gray-400 p-2">静态逆向分析</td>
                            <td className="border border-gray-400 p-2">Ghidra</td>
                            <td className="border border-gray-400 p-2">功能分析报告</td>
                        </tr>
                        <tr>
                            <td className="border border-gray-400 p-2 text-center">5</td>
                            <td className="border border-gray-400 p-2">规则编写测试</td>
                            <td className="border border-gray-400 p-2">Suricata</td>
                            <td className="border border-gray-400 p-2">检测规则文件</td>
                        </tr>
                        <tr>
                            <td className="border border-gray-400 p-2 text-center">6</td>
                            <td className="border border-gray-400 p-2">IoC整理共享</td>
                            <td className="border border-gray-400 p-2">MISP</td>
                            <td className="border border-gray-400 p-2">威胁情报事件</td>
                        </tr>
                    </tbody>
                </table>
                <p className="text-center text-sm mt-2">表 2-1 恶意软件分析流程</p>
            </div>

            <h3 className="text-[14pt] font-hei font-bold mt-6 mb-4">2.3 预期成果</h3>
            <ul className="list-decimal ml-12 mb-4 space-y-2">
                <li><span className="font-bold">流量分析报告：</span>包含C2通信协议分析、加密算法还原、解密后的指令内容</li>
                <li><span className="font-bold">逆向分析报告：</span>包含恶意软件功能模块、持久化机制、配置信息</li>
                <li><span className="font-bold">检测规则集：</span>Snort/Suricata规则，实现100%检出率</li>
                <li><span className="font-bold">IoC清单：</span>包含文件哈希、C2域名/IP、特征字符串等</li>
                <li><span className="font-bold">清除脚本：</span>用于删除持久化注册表键值的PowerShell脚本</li>
            </ul>
        </div>
    );
};
