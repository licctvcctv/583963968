import React from 'react';

// 三、数据库设计（分析环境架构设计）
export const MA03_Design: React.FC = () => {
    return (
        <div className="page bg-white w-[210mm] min-h-[297mm] mx-auto shadow-lg mb-8 p-12 page-break">
            <h2 className="text-[18pt] font-hei mb-6 font-bold">三、分析环境架构设计</h2>

            <h3 className="text-[14pt] font-hei font-bold mt-6 mb-4">3.1 沙箱网络拓扑</h3>
            <p className="mb-4 indent-8 text-justify">
                为确保恶意软件分析的安全性，设计了隔离的沙箱网络环境。分析主机与互联网之间
                通过网关进行流量监控和过滤，所有恶意样本的网络通信都会被捕获和记录。
            </p>
            
            <div className="bg-gray-900 p-6 rounded-lg mb-4 text-green-400 font-mono text-sm">
                <pre>{`
┌─────────────────────────────────────────────────────────────────┐
│                      恶意软件分析沙箱环境                          │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│   ┌─────────────┐      ┌─────────────┐      ┌─────────────┐    │
│   │  Internet   │      │   Gateway   │      │  Kali Linux │    │
│   │             │◄────►│  (监控节点)  │◄────►│  (分析主机)  │    │
│   │  C2 Server  │      │  Wireshark  │      │   Ghidra    │    │
│   └─────────────┘      │  Suricata   │      │   样本运行   │    │
│                        └─────────────┘      └─────────────┘    │
│                              │                    │            │
│                              ▼                    ▼            │
│                        ┌─────────────┐      ┌─────────────┐    │
│                        │  流量存储   │      │  MISP平台   │    │
│                        │  (PCAP)    │      │  (情报共享)  │    │
│                        └─────────────┘      └─────────────┘    │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
`}</pre>
            </div>
            <p className="text-center text-sm font-bold mb-4">图 3-1 沙箱网络拓扑图</p>

            <h3 className="text-[14pt] font-hei font-bold mt-6 mb-4">3.2 数据流设计</h3>
            <table className="w-full border-collapse border border-gray-400 mb-4">
                <thead>
                    <tr className="bg-gray-100">
                        <th className="border border-gray-400 p-2">数据类型</th>
                        <th className="border border-gray-400 p-2">来源</th>
                        <th className="border border-gray-400 p-2">存储格式</th>
                        <th className="border border-gray-400 p-2">用途</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td className="border border-gray-400 p-2">网络流量</td>
                        <td className="border border-gray-400 p-2">Wireshark捕获</td>
                        <td className="border border-gray-400 p-2">PCAP</td>
                        <td className="border border-gray-400 p-2">C2通信分析</td>
                    </tr>
                    <tr>
                        <td className="border border-gray-400 p-2">样本文件</td>
                        <td className="border border-gray-400 p-2">恶意软件库</td>
                        <td className="border border-gray-400 p-2">PE/ELF</td>
                        <td className="border border-gray-400 p-2">逆向分析</td>
                    </tr>
                    <tr>
                        <td className="border border-gray-400 p-2">检测日志</td>
                        <td className="border border-gray-400 p-2">Suricata</td>
                        <td className="border border-gray-400 p-2">JSON/EVE</td>
                        <td className="border border-gray-400 p-2">规则验证</td>
                    </tr>
                    <tr>
                        <td className="border border-gray-400 p-2">IoC数据</td>
                        <td className="border border-gray-400 p-2">分析结果</td>
                        <td className="border border-gray-400 p-2">STIX/TAXII</td>
                        <td className="border border-gray-400 p-2">情报共享</td>
                    </tr>
                </tbody>
            </table>
            <p className="text-center text-sm font-bold mb-4">表 3-1 数据流设计</p>

            <h3 className="text-[14pt] font-hei font-bold mt-6 mb-4">3.3 恶意样本信息</h3>
            <p className="mb-4 indent-8 text-justify">
                本次分析的样本为一个典型的远控木马（RAT），具有以下特征：
            </p>
            <div className="bg-gray-100 p-4 rounded mb-4">
                <table className="w-full">
                    <tbody>
                        <tr>
                            <td className="font-bold w-32">文件名：</td>
                            <td className="font-mono">update_service.exe</td>
                        </tr>
                        <tr>
                            <td className="font-bold">MD5：</td>
                            <td className="font-mono">a1b2c3d4e5f6789012345678abcdef01</td>
                        </tr>
                        <tr>
                            <td className="font-bold">SHA256：</td>
                            <td className="font-mono text-xs">e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855</td>
                        </tr>
                        <tr>
                            <td className="font-bold">文件大小：</td>
                            <td>245,760 bytes</td>
                        </tr>
                        <tr>
                            <td className="font-bold">文件类型：</td>
                            <td>PE32 executable (GUI) Intel 80386</td>
                        </tr>
                        <tr>
                            <td className="font-bold">编译时间：</td>
                            <td>2024-11-15 08:32:45 UTC</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <p className="text-center text-sm font-bold mb-4">表 3-2 恶意样本基本信息</p>
        </div>
    );
};
