import React from 'react';

// 八、课程实训总结 + 参考文献 + 附录
export const MA08_Summary: React.FC = () => {
    return (
        <>
            <div className="page bg-white w-[210mm] min-h-[297mm] mx-auto shadow-lg mb-8 p-12 page-break">
                <h2 className="text-[18pt] font-hei mb-6 font-bold">八、课程实训总结</h2>

                <h3 className="text-[14pt] font-hei font-bold mt-6 mb-4">8.1 项目成果</h3>
                <p className="mb-4 indent-8 text-justify">
                    本次实训项目成功完成了恶意流量分析与逆向的全部任务，主要成果包括：
                </p>
                <ul className="list-decimal ml-12 mb-4 space-y-2">
                    <li>搭建了安全隔离的恶意软件分析沙箱环境</li>
                    <li>使用Wireshark成功捕获并分析了C2通信流量</li>
                    <li>通过逆向分析还原了AES-256-CBC加密算法和密钥</li>
                    <li>编写Python脚本实现了C2通信数据的自动解密</li>
                    <li>使用Ghidra完成静态逆向，定位了3处持久化机制</li>
                    <li>编写4条Suricata规则，实现100%检出率</li>
                    <li>生成完整的IoC清单并接入MISP平台</li>
                </ul>

                <h3 className="text-[14pt] font-hei font-bold mt-6 mb-4">8.2 技术收获</h3>
                <p className="mb-4 indent-8 text-justify">
                    通过本次实训，深入学习和掌握了以下技术：
                </p>
                <ul className="list-disc ml-12 mb-4 space-y-2">
                    <li><span className="font-bold">网络流量分析：</span>熟练使用Wireshark进行流量捕获、过滤和协议分析</li>
                    <li><span className="font-bold">逆向工程：</span>掌握Ghidra的基本使用，能够分析PE文件结构和反编译代码</li>
                    <li><span className="font-bold">加密算法：</span>理解AES加密原理，能够提取密钥并实现解密</li>
                    <li><span className="font-bold">入侵检测：</span>学会编写Suricata规则，理解规则语法和检测逻辑</li>
                    <li><span className="font-bold">威胁情报：</span>了解MISP平台的使用和IoC共享机制</li>
                </ul>

                <h3 className="text-[14pt] font-hei font-bold mt-6 mb-4">8.3 问题与改进</h3>
                <p className="mb-4 indent-8 text-justify">
                    在实训过程中也遇到了一些问题和挑战：
                </p>
                <ul className="list-disc ml-12 mb-4 space-y-2">
                    <li>恶意样本的动态分析需要更完善的沙箱环境，防止样本检测虚拟机</li>
                    <li>加密通信的密钥提取依赖逆向分析能力，需要更多实践积累</li>
                    <li>检测规则的编写需要平衡检出率和误报率</li>
                </ul>

                <h3 className="text-[14pt] font-hei font-bold mt-6 mb-4">8.4 未来展望</h3>
                <p className="mb-4 indent-8 text-justify">
                    后续可以在以下方向继续深入研究：
                </p>
                <ul className="list-disc ml-12 mb-4 space-y-2">
                    <li>学习更高级的反混淆和脱壳技术</li>
                    <li>研究基于机器学习的恶意流量检测方法</li>
                    <li>构建自动化的恶意软件分析流水线</li>
                    <li>深入学习威胁情报的收集和应用</li>
                </ul>
            </div>

            <div className="page bg-white w-[210mm] min-h-[297mm] mx-auto shadow-lg mb-8 p-12 page-break">
                <h2 className="text-[18pt] font-hei mb-6 font-bold">参考文献</h2>
                <ol className="list-decimal ml-8 space-y-3 text-sm">
                    <li>Michael Sikorski, Andrew Honig. Practical Malware Analysis[M]. No Starch Press, 2012.</li>
                    <li>Chris Sanders, Jason Smith. Applied Network Security Monitoring[M]. Syngress, 2013.</li>
                    <li>Ghidra官方文档. https://ghidra-sre.org/</li>
                    <li>Suricata官方文档. https://suricata.io/documentation/</li>
                    <li>MISP Project. https://www.misp-project.org/</li>
                    <li>Wireshark User's Guide. https://www.wireshark.org/docs/</li>
                    <li>NIST SP 800-83. Guide to Malware Incident Prevention and Handling[S]. 2013.</li>
                    <li>MITRE ATT&CK Framework. https://attack.mitre.org/</li>
                </ol>

                <h2 className="text-[18pt] font-hei mb-6 font-bold mt-12">附录</h2>
                
                <h3 className="text-[14pt] font-hei font-bold mt-6 mb-4">附录A：IoC清单</h3>
                <table className="w-full border-collapse border border-gray-400 mb-4 text-sm">
                    <thead>
                        <tr className="bg-gray-100">
                            <th className="border border-gray-400 p-2">类型</th>
                            <th className="border border-gray-400 p-2">值</th>
                            <th className="border border-gray-400 p-2">描述</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td className="border border-gray-400 p-2">MD5</td>
                            <td className="border border-gray-400 p-2 font-mono text-xs">a1b2c3d4e5f6789012345678abcdef01</td>
                            <td className="border border-gray-400 p-2">恶意样本哈希</td>
                        </tr>
                        <tr>
                            <td className="border border-gray-400 p-2">IP</td>
                            <td className="border border-gray-400 p-2 font-mono">192.168.100.50</td>
                            <td className="border border-gray-400 p-2">C2服务器地址</td>
                        </tr>
                        <tr>
                            <td className="border border-gray-400 p-2">URL</td>
                            <td className="border border-gray-400 p-2 font-mono text-xs">http://192.168.100.50:8443/beacon</td>
                            <td className="border border-gray-400 p-2">C2通信端点</td>
                        </tr>
                        <tr>
                            <td className="border border-gray-400 p-2">Registry</td>
                            <td className="border border-gray-400 p-2 font-mono text-xs">HKCU\...\Run\UpdateService</td>
                            <td className="border border-gray-400 p-2">持久化注册表项</td>
                        </tr>
                        <tr>
                            <td className="border border-gray-400 p-2">File Path</td>
                            <td className="border border-gray-400 p-2 font-mono text-xs">%APPDATA%\Microsoft\UpdateService\</td>
                            <td className="border border-gray-400 p-2">恶意文件目录</td>
                        </tr>
                        <tr>
                            <td className="border border-gray-400 p-2">User-Agent</td>
                            <td className="border border-gray-400 p-2 font-mono text-xs">Mozilla/5.0 UpdateService</td>
                            <td className="border border-gray-400 p-2">特征UA字符串</td>
                        </tr>
                    </tbody>
                </table>

                <h3 className="text-[14pt] font-hei font-bold mt-6 mb-4">附录B：MITRE ATT&CK映射</h3>
                <table className="w-full border-collapse border border-gray-400 mb-4 text-sm">
                    <thead>
                        <tr className="bg-gray-100">
                            <th className="border border-gray-400 p-2">战术</th>
                            <th className="border border-gray-400 p-2">技术ID</th>
                            <th className="border border-gray-400 p-2">技术名称</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td className="border border-gray-400 p-2">Persistence</td>
                            <td className="border border-gray-400 p-2">T1547.001</td>
                            <td className="border border-gray-400 p-2">Registry Run Keys</td>
                        </tr>
                        <tr>
                            <td className="border border-gray-400 p-2">Persistence</td>
                            <td className="border border-gray-400 p-2">T1053.005</td>
                            <td className="border border-gray-400 p-2">Scheduled Task</td>
                        </tr>
                        <tr>
                            <td className="border border-gray-400 p-2">C2</td>
                            <td className="border border-gray-400 p-2">T1071.001</td>
                            <td className="border border-gray-400 p-2">Web Protocols</td>
                        </tr>
                        <tr>
                            <td className="border border-gray-400 p-2">C2</td>
                            <td className="border border-gray-400 p-2">T1573.001</td>
                            <td className="border border-gray-400 p-2">Symmetric Cryptography</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </>
    );
};
